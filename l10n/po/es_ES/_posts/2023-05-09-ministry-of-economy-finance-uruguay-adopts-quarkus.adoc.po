# SOME DESCRIPTIVE TITLE
# Copyright (C) YEAR Free Software Foundation, Inc.
# This file is distributed under the same license as the PACKAGE package.
# FIRST AUTHOR <EMAIL@ADDRESS>, YEAR.
#
#, fuzzy
msgid ""
msgstr ""
"Project-Id-Version: PACKAGE VERSION\n"
"POT-Creation-Date: 2023-05-09 16:45+0000\n"
"PO-Revision-Date: YEAR-MO-DA HO:MI+ZONE\n"
"Last-Translator: FULL NAME <EMAIL@ADDRESS>\n"
"Language-Team: LANGUAGE <LL@li.org>\n"
"Language: es_ES\n"
"MIME-Version: 1.0\n"
"Content-Type: text/plain; charset=UTF-8\n"
"Content-Transfer-Encoding: 8bit\n"

#. type: Title =
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy, no-wrap
msgid "MEF and Sofis use Quarkus as core component of a new innovative architecture"
msgstr "MEF y Sofis utilizan Quarkus como componente central de una nueva arquitectura innovadora"

#. type: Title ==
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy, no-wrap
msgid "About us"
msgstr "Quiénes somos"

#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid ""
"The Ministry of Economy and Finance (MEF) of Uruguay is a government ministry. +\n"
"Website: https://www.gub.uy/ministerio-economia-finanzas"
msgstr ""
"El Ministerio de Economía y Finanzas (MEF) de Uruguay es un ministerio gubernamental.\n"
"\n"
" Página web: https://www.gub.uy/ministerio-economia-finanzas"

#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid ""
"Sofis Solutions is a company with more than 18 years of experience in the digital transformation of Latin American organizations and technological inclusion. Focuses mainly on projects for the development of digital government and the resolution of social, environmental and governance problems. +\n"
"Website: https://www.sofis.lat"
msgstr ""
"Sofis Solutions es una empresa con más de 18 años de experiencia en la transformación digital de las organizaciones latinoamericanas y la inclusión tecnológica. Se enfoca principalmente en proyectos para el desarrollo del gobierno digital y la resolución de problemas sociales, ambientales y de gobernabilidad.\n"
"\n"
" Página web: https://www.sofis.lat"

#. type: Title ==
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy, no-wrap
msgid "Problem statement"
msgstr "Planteamiento del problema"

#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid ""
"The current Integrated Financial Information System (SIIF) of the Uruguayan Ministry of Economy and Finance relies on Oracle Forms, which presents certain drawbacks such as limited compatibility, inflexibility, high maintenance costs, and limited support. To ensure long-term viability and modernization, an architecture update is needed. The main objective is to establish a scalable reference architecture that enables SIIF to evolve as part of the modernization process.\n"
"In late 2021 an architecture team was formed, and work began following the https://pubs.opengroup.org/architecture/togaf92-doc/arch/[TOGAF Architecture Development Method 9.2]."
msgstr "El actual Sistema Integrado de Información Financiera (SIIF) del Ministerio de Economía y Finanzas de Uruguay se basa en Oracle Forms, que presenta ciertos inconvenientes como una compatibilidad limitada, inflexibilidad, elevados costes de mantenimiento y un soporte limitado. Para garantizar la viabilidad a largo plazo y la modernización, es necesario actualizar la arquitectura. El objetivo principal es establecer una arquitectura de referencia escalable que permita al SIIF evolucionar como parte del proceso de modernización. A finales de 2021 se formó un equipo de arquitectura y se empezó a trabajar siguiendo el link:https://pubs.opengroup.org/architecture/togaf92-doc/arch/[método de desarrollo de arquitectura TOGAF 9.2] ."

#. type: Title ===
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy, no-wrap
msgid "Key requirements"
msgstr "Requisitos clave"

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "The key requirements of this modernized architecture were:"
msgstr "Los requisitos clave de esta arquitectura modernizada eran:"

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "It must be possible to audit transactions and changes made to entities."
msgstr "Debe ser posible auditar las transacciones y los cambios realizados en las entidades."

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "During runtime, software systems should generate metrics that provide visibility into the operational status of each component. These metrics should be accessible through a centralized monitoring platform, which should enable the visualization of the current status and generation of alerts."
msgstr "Durante el tiempo de ejecución, los sistemas de software deben generar métricas que proporcionen visibilidad sobre el estado operativo de cada componente. Estas métricas deben ser accesibles a través de una plataforma de monitorización centralizada, que debe permitir la visualización del estado actual y la generación de alertas."

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "Under normal production conditions, the system must respond with a latency of less than one second."
msgstr "En condiciones normales de producción, el sistema debe responder con una latencia inferior a un segundo."

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "A monthly availability of the solution of 99% is required within office hours and 95% outside of office hours."
msgstr "Se requiere una disponibilidad mensual de la solución del 99% dentro del horario de oficina y del 95% fuera del horario de oficina."

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "Systems should be able to handle an increasing workload, such as the addition of new user groups, higher volumes of traffic, or more complex transactions, by utilizing horizontal scaling techniques. Services must be deployed as Docker containers."
msgstr "Los sistemas deben ser capaces de manejar una carga de trabajo creciente, como la adición de nuevos grupos de usuarios, mayores volúmenes de tráfico o transacciones más complejas, utilizando técnicas de escalado horizontal. Los servicios deben desplegarse como contenedores Docker."

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "Communication between systems using REST (preferred) and SOAP (legacy) protocols must be supported."
msgstr "Debe admitirse la comunicación entre sistemas que utilicen protocolos REST (preferido) y SOAP (heredado)."

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "Software must be able to be tested on a unitary, integration and system-wide basis."
msgstr "El software debe poder someterse a pruebas unitarias, de integración y de todo el sistema."

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "The central data repository of the transactional system must maintain permanent data integrity and consistency. This consistency must be ensured despite technical failures or crashes of other components."
msgstr "El repositorio central de datos del sistema transaccional debe mantener la integridad y coherencia permanentes de los datos. Esta coherencia debe garantizarse a pesar de fallos técnicos o caídas de otros componentes."

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "All the log data and exceptions must be properly captured and centrally managed."
msgstr "Todos los datos de registro y las excepciones deben capturarse adecuadamente y gestionarse de forma centralizada."

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "Software that is being developed should be highly configurable to ensure it can be deployed across various installation environments, such as development, testing, pre-production, production, etc. without the need for recompiling it for each environment."
msgstr "El software que se desarrolla debe ser altamente configurable para garantizar que pueda desplegarse en varios entornos de instalación, como desarrollo, pruebas, preproducción, producción, etc. sin necesidad de recompilarlo para cada entorno."

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "Components should easily integrate with distributed event streaming platforms as Kafka."
msgstr "Los componentes deben integrarse fácilmente con plataformas de streaming de eventos distribuidos como Kafka."

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "Framework utilized must enhance developer experience. Live reload while coding is highly valuable."
msgstr "El marco utilizado debe mejorar la experiencia del desarrollador. La recarga en vivo durante la codificación es muy valiosa."

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "Coding must be aligned with Java EE and MicroProfile ecosystems."
msgstr "La codificación debe estar alineada con los ecosistemas Java EE y MicroProfile."

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "Components must provide a mechanism that allows health monitoring through the health monitor of the platform."
msgstr "Los componentes deben proporcionar un mecanismo que permita la supervisión de la salud a través del monitor de salud de la plataforma."

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "We selected Quarkus as the framework for our backends based on its ability to fulfill all our critical requirements. Its extensive features, capabilities, and active community were precisely what we were looking for, making it an essential tool for our projects."
msgstr "Elegimos Quarkus como framework para nuestros backends por su capacidad para satisfacer todos nuestros requisitos críticos. Sus amplias funciones, capacidades y comunidad activa eran precisamente lo que buscábamos, lo que lo convierte en una herramienta esencial para nuestros proyectos."

#. type: Title ==
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, no-wrap
msgid "Architecture"
msgstr "Arquitectura"

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "The architecture diagrams are made following the https://c4model.com/[C4 model]. Systems are composed of modules implemented using a macroservices approach that are larger than microservices but smaller than monolithic applications. A simplified version of the system landscape is presented below:"
msgstr "Los diagramas de arquitectura se realizan siguiendo el  link:https://c4model.com/[modelo C4]. Los sistemas se componen de módulos implementados mediante un enfoque de macroservicios que son más grandes que los microservicios pero más pequeños que las aplicaciones monolíticas. A continuación se presenta una versión simplificada del paisaje del sistema:"

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "Description:"
msgstr "Descripción:"

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "System 1 to N. Can be any of the systems used in MEF."
msgstr "Sistema 1 a N. Puede ser cualquiera de los sistemas utilizados en MEF."

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "Security system. Management of users, roles, operations, audit logs, etc."
msgstr "Sistema de seguridad. Gestión de usuarios, roles, operaciones, registros de auditoría, etc."

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "https://mi.iduruguay.gub.uy/[ID Uruguay]. AGESIC Identity and Authentication Provider. Users must start an OAuth2 authentication flow against this provider via MEF applications."
msgstr "link:https://mi.iduruguay.gub.uy/[ID Uruguay]. Proveedor de Identidad y Autenticación AGESIC. Los usuarios deben iniciar un flujo de autenticación OAuth2 contra este proveedor a través de aplicaciones MEF."

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "External system. Represents an external system that consumes MEF APIs."
msgstr "Sistema externo. Representa un sistema externo que consume API de MEF."

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "In addition to the internal systems, some of the most relevant tools we use are:"
msgstr "Además de los sistemas internos, algunas de las herramientas más relevantes que utilizamos son:"

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "Kubernetes. Container orchestrator."
msgstr "Kubernetes. Orquestador de contenedores."

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "Ceph. Storage platform."
msgstr "Ceph. Plataforma de almacenamiento."

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "Elasticsearch, Fluentd, Kibana stack. Storage and visualization of log and audit data."
msgstr "Pila Elasticsearch, Fluentd, Kibana. Almacenamiento y visualización de datos de registro y auditoría."

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "Prometheus, Alertmanager, Grafana stack. Visualization of infrastructure and services metrics. Also responsible for generating alerts."
msgstr "Prometheus, Alertmanager, Grafana stack. Visualización de métricas de infraestructura y servicios. También responsable de la generación de alertas."

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "Matomo. Used to obtain user analytics and their behavior on websites."
msgstr "Matomo. Se utiliza para obtener análisis de los usuarios y su comportamiento en los sitios web."

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "Apache Kafka. Distributed event streaming platform."
msgstr "Apache Kafka. Plataforma distribuida de streaming de eventos."

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "Apache APISIX API Gateway. Manage and expose APIs."
msgstr "Apache APISIX API Gateway. Gestionar y exponer APIs."

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "ArgoCD. GitOps continuous delivery tool."
msgstr "ArgoCD. Herramienta de entrega continua GitOps."

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "GitLab. Code repository and CI/CD DevOps tool."
msgstr "GitLab. Repositorio de código y herramienta CI/CD DevOps."

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "Nexus. Repository for libraries and Docker images."
msgstr "Nexus. Repositorio de bibliotecas e imágenes Docker."

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "SonarQube. Static code analysis tool."
msgstr "SonarQube. Herramienta de análisis estático de código."

#. type: Title ==
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy, no-wrap
msgid "Kubernetes"
msgstr "Kubernetes"

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "Kubernetes is an open-source container orchestration system for automating software deployment, scaling, and management. The combination of Quarkus and Kubernetes provides an ideal environment for creating scalable, fast, and lightweight applications. Our applications and tools are deployed in two on-premise Kubernetes clusters for production and non-production environments."
msgstr "Kubernetes es un sistema de orquestación de contenedores de código abierto para automatizar el despliegue, el escalado y la gestión de software. La combinación de Quarkus y Kubernetes proporciona un entorno ideal para crear aplicaciones escalables, rápidas y ligeras. Nuestras aplicaciones y herramientas se despliegan en dos clústeres Kubernetes locales para entornos de producción y no producción."

#. type: Title ===
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy, no-wrap
msgid "ArgoCD and Kustomize"
msgstr "ArgoCD y Kustomize"

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "ArgoCD is a Kubernetes operator that utilizes CRDs (Custom Resource Definitions) to configure its operation. These CRDs enable the definition of infrastructure through Git-stored files and automate deployment following any changes made."
msgstr "ArgoCD es un operador Kubernetes que utiliza CRDs (Custom Resource Definitions) para configurar su funcionamiento. Estas CRDs permiten definir la infraestructura a través de archivos almacenados en Git y automatizar el despliegue tras cualquier cambio realizado."

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "Kustomize adheres to Kubernetes principles by leveraging Kubernetes objects to define configuration files and manage these configurations declaratively. A Kustomization object defines how to generate or transform other Kubernetes objects and is created in a file named kustomization.yaml, which can be edited by Kustomize itself. Kustomizations can be patched with overlays to overwrite base settings and create variants. ArgoCD offers seamless Kustomize support, allowing for more efficient and effective management of Kubernetes configurations."
msgstr "Kustomize se adhiere a los principios de Kubernetes aprovechando los objetos de Kubernetes para definir archivos de configuración y gestionar estas configuraciones de forma declarativa. Un objeto Kustomization define cómo generar o transformar otros objetos Kubernetes y se crea en un archivo llamado kustomization.yaml, que puede ser editado por el propio Kustomize. Las personalizaciones pueden parchearse con superposiciones para sobrescribir la configuración base y crear variantes. ArgoCD ofrece compatibilidad sin fisuras con Kustomize, lo que permite una gestión más eficiente y eficaz de las configuraciones de Kubernetes."

#. type: Title ==
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy, no-wrap
msgid "Ceph"
msgstr "Ceph"

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "Ceph is an open source software-defined storage platform that implements object storage on a single distributed computer cluster and provides 3-in-1 interfaces for object, block and file level storage. We have two on-premise clusters (prod and non-prod) that are integrated with our Kubernetes clusters."
msgstr "Ceph es una plataforma de almacenamiento definido por software de código abierto que implementa el almacenamiento de objetos en un único clúster informático distribuido y proporciona interfaces 3 en 1 para el almacenamiento a nivel de objetos, bloques y archivos. Disponemos de dos clústeres locales (de producción y de no producción) que están integrados con nuestros clústeres de Kubernetes."

#. type: Title ==
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy, no-wrap
msgid "CI/CD"
msgstr "CI/CD"

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "We are currently using a customized CI/CD flow based primarily on https://nvie.com/posts/a-successful-git-branching-model/[A successful Git branching model]. All the CI/CD tasks are implemented using GitLab."
msgstr "Actualmente estamos utilizando un flujo CI/CD personalizado basado principalmente en  link:https://nvie.com/posts/a-successful-git-branching-model/[un modelo de ramificación Git de éxito]. Todas las tareas de CI/CD se implementan utilizando GitLab."

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "We follow the \"build once deploy anywhere\" approach whenever possible. The code is built using s2i (source to image) and the images are propagated through the different environments (development, integration, test/QA, training, preprod and production)."
msgstr "Siempre que es posible, seguimos el enfoque \"build once deploy anywhere\". El código se construye utilizando s2i (source to image) y las imágenes se propagan por los distintos entornos (desarrollo, integración, pruebas/QA, formación, preproducción y producción)."

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "Our type of development requires us to have 3 unique long lived branches per project:"
msgstr "Nuestro tipo de desarrollo nos obliga a tener 3 ramas únicas de larga duración por proyecto:"

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "Main. Where all the developers continuously merge their new features."
msgstr "Principal. Donde todos los desarrolladores fusionan continuamente sus nuevas funciones."

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "Release. When the code in main is ready to be released to QA, it is merged to the release branch. Release can be evolved independently of main while bugfixes are applied."
msgstr "Liberación. Cuando el código en main está listo para ser liberado a QA, se fusiona con la rama release. Release puede evolucionar independientemente de main mientras se aplican las correcciones de errores."

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "Production. Where the code released to production is. Hotfixes branches are created from it."
msgstr "Producción. Donde está el código liberado a producción. A partir de él se crean las ramas de Hotfixes."

#. type: Title ==
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy, no-wrap
msgid "Metrics"
msgstr "Métrica"

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "The Prometheus-Grafana combination has become one of the most popular solutions for monitoring, alerting, and visualization in the cloud-native space. Prometheus is an open source systems monitoring and alerting toolkit. Grafana is a multi-platform open source analytics and interactive visualization web application. It provides out of the box support to display data collected by Prometheus."
msgstr "La combinación Prometheus-Grafana se ha convertido en una de las soluciones más populares de supervisión, alerta y visualización en el espacio nativo de la nube. Prometheus es un conjunto de herramientas de alerta y supervisión de sistemas de código abierto. Grafana es una aplicación web de análisis y visualización interactiva de código abierto multiplataforma. Proporciona soporte inmediato para mostrar los datos recopilados por Prometheus."

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "With them, we can gather, visualize and react to metrics from Kubernetes, CephFS, Apache APISIX, Elasticsearch, Kafka, Zookeeper, databases, backends, frontends and more."
msgstr "Con ellos, podemos recopilar, visualizar y reaccionar ante métricas de Kubernetes, CephFS, Apache APISIX, Elasticsearch, Kafka, Zookeeper, bases de datos, backends, frontends y mucho más."

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "To start exposing metrics with Quarkus, the `quarkus-micrometer-registry-prometheus` extension must be added. This allows us to get interesting metrics about our application as CPU, heap, non heap, http requests, etc. With the default HTTP metrics exposed, we are able to get the following insights by method:"
msgstr "Para empezar a exponer métricas con Quarkus, hay que añadir la extensión `quarkus-micrometer-registry-prometheus`. Esto nos permite obtener métricas interesantes sobre nuestra aplicación como CPU, heap, non heap, peticiones http, etc. Con las métricas HTTP expuestas por defecto, podemos obtener los siguientes datos por método:"

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "Total number of requests"
msgstr "Número total de solicitudes"

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "Maximum request duration"
msgstr "Duración máxima de la solicitud"

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "Average request duration"
msgstr "Duración media de la solicitud"

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "Sum of the duration of every request"
msgstr "Suma de la duración de cada solicitud"

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "To determine whether the maximum request duration is an isolated case or is occurring on many requests, percentiles must be used."
msgstr "Para determinar si la duración máxima de la solicitud es un caso aislado o se da en muchas solicitudes, hay que utilizar los percentiles."

#. type: Title ===
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy, no-wrap
msgid "Percentiles"
msgstr "Percentiles"

#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid ""
"A percentile is a measure used in statistics indicating the value below which a given percentage of observations in a group of observations fall. For example, the response time for a HTTP request below which 90% of the response time values lie, is called the 90-percentile response time.\n"
"The recommended way to calculate percentiles is using the \"Percentiles Histogram\" approach. See https://micrometer.io/docs/concepts#_histograms_and_percentiles.\n"
"Quarkus (and Micrometer) let you enable this kind of metric by defining a `@Singleton` MeterFilterProducer. Example code below:"
msgstr "Un percentil es una medida utilizada en estadística que indica el valor por debajo del cual se sitúa un porcentaje determinado de observaciones en un grupo de observaciones. Por ejemplo, el tiempo de respuesta de una solicitud HTTP por debajo del cual se encuentra el 90% de los valores de tiempo de respuesta, se denomina tiempo de respuesta del percentil 90. La forma recomendada de calcular los percentiles es utilizando el enfoque del \"Histograma de percentiles\". link:https://micrometer.io/docs/concepts#_histograms_and_percentiles[Véase https://micrometer.io/docs/concepts#_histograms_and_percentiles.] Quarkus (y Micrometer) le permiten habilitar este tipo de métrica definiendo un `@Singleton` MeterFilterProducer. Código de ejemplo a continuación:"

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "With this new exposed metrics we can define, for example:"
msgstr "Con esta nueva métrica expuesta podemos definir, por ejemplo:"

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "An alert in Prometheus that will fire when the 95 percentile request duration time is above 300ms."
msgstr "Una alerta en Prometheus que se disparará cuando el percentil 95 del tiempo de duración de la solicitud sea superior a 300 ms."

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "An interactive chart in Grafana to display some desired percentiles as 50, 75, 90, 95, 99 and 1:"
msgstr "Un gráfico interactivo en Grafana para mostrar algunos percentiles deseados como 50, 75, 90, 95, 99 y 1:"

#. type: Title ==
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy, no-wrap
msgid "Authentication and authorization"
msgstr "Autenticación y autorización"

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "Our API security is implemented with Json Web Tokens. We have a centralized auth service that generates JWT, which are used by users and applications to consume the exposed APIs. Every backend has access to the public key and can validate the signature on their own. For protecting the endpoints, the `@RolesAllowed` annotation is being used. In addition to that, the `quarkus-security` extension must be added."
msgstr "La seguridad de nuestra API se implementa con Json Web Tokens. Tenemos un servicio de autenticación centralizado que genera JWT, que son utilizados por usuarios y aplicaciones para consumir las APIs expuestas. Cada backend tiene acceso a la clave pública y puede validar la firma por sí mismo. Para proteger los endpoints, se utiliza la anotación `@RolesAllowed`. Además, debe añadirse la extensión `quarkus-security`."

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "You may already be familiar with the \"groups\" attribute in JSON Web Tokens (JWTs), which typically maps to the `@RolesAllowed` property in many jwt-security validation libraries. However, this approach assumes that roles need to be hardcoded, which may not always be suitable. In our case, we wanted the security on the endpoints to be operation-oriented, so that a user can have dynamic roles, with different operations. To accomplish this:"
msgstr "Es posible que ya esté familiarizado con el atributo \"groups\" de los tokens web JSON (JWT), que normalmente se asigna a la propiedad `@RolesAllowed` en muchas bibliotecas de validación de seguridad jwt. Sin embargo, este enfoque asume que los roles deben ser codificados, lo que no siempre es adecuado. En nuestro caso, queríamos que la seguridad en los puntos finales estuviera orientada a las operaciones, de modo que un usuario pueda tener roles dinámicos, con diferentes operaciones. Para lograrlo:"

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "Each endpoint must be mapped to a single operation."
msgstr "Cada punto final debe asignarse a una única operación."

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "A way to map between JWT groups and operations is needed. Storing operations in the groups attribute of a JWT is not ideal, as the array could be significant, resulting in a large token."
msgstr "Se necesita una forma de mapear entre grupos JWT y operaciones. Almacenar operaciones en el atributo groups de un JWT no es lo ideal, ya que la matriz podría ser significativa, lo que daría lugar a un token de gran tamaño."

#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid ""
"We decided to implement the JWT validation using a `ContainerRequestFilter`, as exposed in https://quarkus.io/guides/security-customization#jaxrs-security-context. In that filter the JWT groups are obtained and a cached method with `@CacheResult` is invoked to obtain the related operations.\n"
"As of today, we are using a memory cache with Caffeine for simplicity, but the new Redis as cache backend introduced in Quarkus 3 seems to be a good alternative, as we would be able to share the cache between all the instances. See https://quarkus.io/version/main/guides/cache-redis-reference."
msgstr "Decidimos implementar la validación JWT utilizando un filtro `ContainerRequestFilter` , tal y como se expone en link:https://quarkus.io/guides/security-customization#jaxrs-security-context[https://quarkus.io/guides/security-customization#jaxrs-security-context.] En ese filtro se obtienen los grupos JWT y se invoca un método en caché con `@CacheResult` para obtener las operaciones relacionadas. A día de hoy, estamos utilizando una caché de memoria con Caffeine por simplicidad, pero el nuevo Redis como backend de caché introducido en Quarkus 3 parece ser una buena alternativa, ya que podríamos compartir la caché entre todas las instancias. Véase link:https://quarkus.io/version/main/guides/cache-redis-reference[https://quarkus.io/version/main/guides/cache-redis-reference.]"

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "The `SecurityContext` `isUserInRole` method is overrided as:"
msgstr "El método `SecurityContext` `isUserInRole` se anula como:"

#. type: Title ==
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy, no-wrap
msgid "Audit requests"
msgstr "Solicitudes de auditoría"

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "A common requirement is to audit the requests that are made to our APIs. It was decided to:"
msgstr "Un requisito común es auditar las solicitudes que se realizan a nuestras API. Se decidió hacerlo:"

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "Store it as data streams in Elasticsearch."
msgstr "Almacénelos como flujos de datos en Elasticsearch."

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "Store it asynchronously, without interfering with the request."
msgstr "Almacénelo de forma asíncrona, sin interferir con la solicitud."

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "Always audit POST, PUT, PATCH, and DELETE methods. In a few special cases also GET methods."
msgstr "Audite siempre los métodos POST, PUT, PATCH y DELETE. En algunos casos especiales, también los métodos GET."

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "We wanted to audit params like service, requestDate, responseDate, method, baseUri, path, queryParams, userId, ip, traceId, traceApplicationChain, responseStatus, requestBody (optional) and responseBody (optional)."
msgstr "Queríamos auditar parámetros como service, requestDate, responseDate, method, baseUri, path, queryParams, userId, ip, traceId, traceApplicationChain, responseStatus, requestBody (opcional) y responseBody (opcional)."

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "For doing so, we implemented some utility classes:"
msgstr "Para ello, hemos implementado algunas clases de utilidad:"

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "A `ContainerRequestFilter`, to get some params such as request start date and propagate them through `ContainerRequestContext`."
msgstr "A `ContainerRequestFilter`, para obtener algunos parámetros como la fecha de inicio de la solicitud y propagarlos a través de `ContainerRequestContext`."

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "A `ContainerResponseFilter`, to get the rest of the params and invoke a method in charge of sending an audit event to a Kafka topic. We decided to send the event only in the response filter for performance reasons, assuming that there can be minimal loss if it is not invoked."
msgstr "A `ContainerResponseFilter`, para obtener el resto de los params e invocar un método encargado de enviar un evento de auditoría a un topic de Kafka. Decidimos enviar el evento sólo en el filtro de respuesta por razones de rendimiento, asumiendo que puede haber una pérdida mínima si no se invoca."

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "An `@AuditedEndpoint` annotation, used to identify and customize the methods that we want to audit. The API methods not annotated, are ignored by the filter. This annotation has two boolean parameters that can be customized at method level: `auditRequestBody` (true by default) and `auditResponseBody` (false by default)."
msgstr "Una anotación `@AuditedEndpoint`, utilizada para identificar y personalizar los métodos que queremos auditar. Los métodos de la API no anotados, son ignorados por el filtro. Esta anotación tiene dos parámetros booleanos que se pueden personalizar a nivel de método: `auditRequestBody` (verdadero por defecto) y `auditResponseBody` (falso por defecto)."

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "Sending an imperative event to Kafka can be done with an Emitter (see https://quarkus.io/guides/kafka#sending-messages-with-emitter). The `quarkus-smallrye-reactive-messaging-kafka` extension has to be added."
msgstr "El envío de un evento imperativo a Kafka puede realizarse con un Emitter (  https://quarkus.io/guides/kafka#sending-messages-with-emitter . Es necesario añadir la extensión `quarkus-smallrye-reactive-messaging-kafka`."

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "After we have the events in the topic, we need a way to process and store them in Elasticsearch. To perform this task, we are using the Elasticsearch Service Sink Connector deployed within Kafka Connect. Kafka Connect is a tool for scalably and reliably streaming data between Apache Kafka and other data systems. It makes it simple to quickly define connectors that move large data sets in and out of Kafka. See https://docs.confluent.io/platform/current/connect/index.html."
msgstr "Después de tener los eventos en el tema, necesitamos una forma de procesarlos y almacenarlos en Elasticsearch. Para realizar esta tarea, estamos utilizando el Elasticsearch Service Sink Connector desplegado dentro de Kafka Connect. Kafka Connect es una herramienta para transmitir datos de forma escalable y fiable entre Apache Kafka y otros sistemas de datos. Facilita la definición rápida de conectores que mueven grandes conjuntos de datos dentro y fuera de Kafka. Véase  https://docs.confluent.io/platform/current/connect/index.html"

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "In addition, we are also employing Hibernate Envers for entity-oriented auditing."
msgstr "Además, también estamos empleando Hibernate Envers para la auditoría orientada a entidades."

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "Besides audit event processing, Kafka will be used as a mechanism for communication between services (and systems) that have independent databases."
msgstr "Además del procesamiento de eventos de auditoría, Kafka se utilizará como mecanismo de comunicación entre servicios (y sistemas) que tienen bases de datos independientes."

#. type: Title ==
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy, no-wrap
msgid "Database schemas and migrations"
msgstr "Esquemas y migraciones de bases de datos"

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "We have several environments e.g. development, integration, test/QA, training, preprod and production.  It is necessary to automate the execution of the scripts as the services are deployed in the different environments. Flyway is a great tool to achieve that. It allows you to:"
msgstr "Disponemos de varios entornos, por ejemplo, desarrollo, integración, pruebas/QA, formación, preproducción y producción. Es necesario automatizar la ejecución de los scripts a medida que los servicios se despliegan en los diferentes entornos. Flyway es una gran herramienta para conseguirlo. Te permite:"

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "Recreate a database from scratch."
msgstr "Volver a crear una base de datos desde cero."

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "Make it clear at all times what state a database is in."
msgstr "Deje claro en todo momento en qué estado se encuentra una base de datos."

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "Migrate in a deterministic way from your current version of the database to a newer one."
msgstr "Migre de forma determinista de su versión actual de la base de datos a una más reciente."

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "The `quarkus-flyway` extension is needed. When running tests, or deploying the service, the migration functionality will kick in to apply the necessary scripts."
msgstr "Se necesita la extensión `quarkus-flyway`. Al ejecutar pruebas o desplegar el servicio, la funcionalidad de migración se activará para aplicar los scripts necesarios."

#. type: Title ===
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy, no-wrap
msgid "Our custom case (1)"
msgstr "Nuestro maletín a medida (1)"

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "Our system types require having groups of services sharing a single database (see https://microservices.io/patterns/data/shared-database.html). Additionaly, in some cases, legacy databases exist. Recreating the full structure from scratch with new migrations is a difficult task."
msgstr "Nuestros tipos de sistemas requieren tener grupos de servicios que compartan una única base de datos (  https://microservices.io/patterns/data/shared-database.html . Además, en algunos casos, existen bases de datos heredadas. Recrear toda la estructura desde cero con nuevas migraciones es una tarea difícil."

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "Decisions and implications:"
msgstr "Decisiones e implicaciones:"

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "For legacy databases, a Flyway \"baseline\" should be created with the current state, and migrations applied after that point."
msgstr "Para las bases de datos heredadas, debe crearse una \"línea de base\" Flyway con el estado actual, y aplicar las migraciones a partir de ese momento."

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "Each service has its own schema in the database and is responsible for its evolution. A `flyway_schema_history` table by schema is needed."
msgstr "Cada servicio tiene su propio esquema en la base de datos y es responsable de su evolución. Se necesita una tabla `flyway_schema_history` por esquema."

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "In certain cases, a table in schema A can have a foreign key to schema B. Therefore, one service may need structures from another in order to run correctly. This enforces that the service owner of schema B must be released before the owner of schema A. As a common rule, we avoid if possible having bidirectional foreign keys between A and B."
msgstr "En ciertos casos, una tabla del esquema A puede tener una clave ajena al esquema B. Por lo tanto, un servicio puede necesitar estructuras de otro para funcionar correctamente. Esto obliga a que el propietario del servicio del esquema B se libere antes que el propietario del esquema A. Como norma común, evitamos en la medida de lo posible tener claves foráneas bidireccionales entre A y B."

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "Automated tests must run against an existing database with all the structures. A single backend cannot re-create the entire database. See <<Automatic testing / Code analysis>>."
msgstr "Las pruebas automatizadas deben ejecutarse contra una base de datos existente con todas las estructuras. Un único backend no puede recrear toda la base de datos. Véase  link:#Automatic testing / Code analysis[[Pruebas automáticas / Análisis del código]]."

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "Note that when working with some databases like Oracle or MySQL, failed DDL migrations are not automatically rolled back. See https://flywaydb.org/documentation/learnmore/faq#rollback. We found two ways of mitigating this situation:"
msgstr "Tenga en cuenta que cuando se trabaja con algunas bases de datos como Oracle o MySQL, las migraciones DDL fallidas no se revierten automáticamente. Véase  https://flywaydb.org/documentation/learnmore/faq#rollback  Hemos encontrado dos maneras de mitigar esta situación:"

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "Run the tests in a environment where `quarkus.flyway.clean-on-validation-error=true`. That allows to test all the migrations before releasing to another environment. Mostly useful in new services that do not share the database."
msgstr "Ejecute las pruebas en un entorno en el que `quarkus.flyway.clean-on-validation-error=true`. Eso permite probar todas las migraciones antes de liberar a otro entorno. Muy útil en nuevos servicios que no comparten la base de datos."

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "Create independent migrations by feature. In this case, migrations should be small, and it will be easier to rollback. To avoid name collision between migrations of the same version, a timestamp in the name and `quarkus.flyway.out-of-order=true` might be used."
msgstr "Cree migraciones independientes por características. En este caso, las migraciones deben ser pequeñas y será más fácil revertirlas. Para evitar la colisión de nombres entre migraciones de la misma versión, puede utilizarse una marca de tiempo en el nombre y `quarkus.flyway.out-of-order=true`."

#. type: Title ===
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy, no-wrap
msgid "Our custom case (2)"
msgstr "Nuestro maletín a medida (2)"

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "The management of users, roles, operations of all the systems is handled in one transversal security management system with his own database. When a backend exposes a new API, it defines a new operation and a `@RolesAllowed` annotation. It might also need to create new roles if needed. This new data must be persisted/updated in the security system database. We need to trigger such updates as part of the service CI/CD flow. To resolve this situation, the services need two folders of migrations: `db/migration` (for the service schema) and `db/migrationsecurity` (for the security database). At the security database, each service has its own \"flyway_schema_history\" table, to keep record of the migrations executed. For example \"fsh_service_A\", \"fsh_service_B\", etc."
msgstr "La gestión de usuarios, roles y operaciones de todos los sistemas se gestiona en un sistema transversal de gestión de la seguridad con su propia base de datos. Cuando un backend expone una nueva API, define una nueva operación y una anotación `@RolesAllowed`. Puede que también necesite crear nuevos roles si es necesario. Estos nuevos datos deben persistir/actualizarse en la base de datos del sistema de seguridad. Necesitamos activar dichas actualizaciones como parte del flujo CI/CD del servicio. Para resolver esta situación, los servicios necesitan dos carpetas de migraciones: `db/migration` (para el esquema de servicio) y `db/migrationsecurity` (para la base de datos de seguridad). En la base de datos de seguridad, cada servicio tiene su propia tabla \"flyway_schema_history\", para mantener un registro de las migraciones ejecutadas. Por ejemplo, \"fsh_service_A\", \"fsh_service_B\", etc."

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "How do we do it? The default `db/migration` folder is handled by Quarkus when running tests or deploying. On the other hand, the `db/migrationsecurity` is picked up by a GitLab job that runs before deploying the app to any environment. As the security database is shared across all the services in that environment, the Flyway configurations can be declared in a unified way as GitLab CI/CD variables. Another approach thay may also work is using the `quarkus.flyway.\"named-data-sources\"` properties, that let you apply migrations in different datasources."
msgstr "¿Cómo lo hacemos? La carpeta por defecto `db/migration` es manejada por Quarkus cuando se ejecutan las pruebas o el despliegue. Por otro lado, `db/migrationsecurity` es recogida por un trabajo de GitLab que se ejecuta antes de desplegar la aplicación en cualquier entorno. Como la base de datos de seguridad se comparte en todos los servicios de ese entorno, las configuraciones de Flyway pueden declararse de forma unificada como variables de GitLab CI/CD. Otro enfoque que también puede funcionar es el uso de las propiedades de `quarkus.flyway.\"named-data-sources\"`, que permiten aplicar migraciones en diferentes fuentes de datos."

#. type: Title ==
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy, no-wrap
msgid "Automatic testing and code analysis"
msgstr "Pruebas automáticas y análisis de código"

#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid ""
"To implement automated testing the `quarkus-junit5` extension is needed.\n"
"As mentioned above, our automated tests have to run against an existing database with all the necessary structures. For that reason, we are not able to set up test databases from scratch, for example using TestContainers. We also need to have a way to rollback the changes introduced by tests. Doing the latter is really easy thanks to the `@TestTransaction` annotation provided by Quarkus (see https://quarkus.io/guides/getting-started-testing#tests-and-transactions).\n"
"Transactional testing is really useful, as it allows us to run tests against a real database, without the need for mocking. Along with testing the methods logic, it also guarantees that the entities and tables are correctly defined."
msgstr "Para implementar las pruebas automatizadas se necesita la extensión `quarkus-junit5` . Como ya se ha mencionado, nuestras pruebas automatizadas tienen que ejecutarse contra una base de datos existente con todas las estructuras necesarias. Por ese motivo, no podemos crear bases de datos de pruebas desde cero, por ejemplo utilizando TestContainers. También necesitamos disponer de una forma de revertir los cambios introducidos por las pruebas. Hacer esto último es realmente fácil gracias a la anotación `@TestTransaction` proporcionada por Quarkus ( link:https://quarkus.io/guides/getting-started-testing#tests-and-transactions[véase https://quarkus.io/guides/getting-started-testing#tests-and-transactions)] . Las pruebas transaccionales son realmente útiles, ya que nos permiten ejecutar pruebas contra una base de datos real, sin necesidad de mocking. Además de probar la lógica de los métodos, también garantiza que las entidades y las tablas están correctamente definidas."

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "Regarding code analysis, we are using two Maven plugins: `sonar-maven-plugin` and `dependency-check-maven`. SonarQube is an open source platform developed by SonarSource for continuous inspection of code quality to perform automatic reviews with static analysis of code to detect bugs and code smells. Dependency-Check is a Software Composition Analysis tool that attempts to detect publicly disclosed vulnerabilities contained within a project's dependencies. A plugin can be installed in SonarQube to integrate with dependency check reports."
msgstr "En cuanto al análisis de código, estamos utilizando dos plugins de Maven: `sonar-maven-plugin` y `dependency-check-maven`. SonarQube es una plataforma de código abierto desarrollada por SonarSource para la inspección continua de la calidad del código con el fin de realizar revisiones automáticas con análisis estático del código para detectar errores y olores de código. Dependency-Check es una herramienta de análisis de composición de software que intenta detectar vulnerabilidades de dominio público contenidas en las dependencias de un proyecto. Se puede instalar un plugin en SonarQube para integrarlo con los informes de comprobación de dependencias."

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "The `quarkus-jacoco` extension is also used to get the coverage of the tests. The generated report is picked up by SonarQube, and the results are used to check against the quality gate."
msgstr "La extensión `quarkus-jacoco` también se utiliza para obtener la cobertura de las pruebas. El informe generado es recogido por SonarQube, y los resultados se utilizan para comprobar contra la puerta de calidad."

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "Code analysis tools can take some time. For that reason, we decided to run this tasks only on nightly builds fired by GitLab scheduler. This decision depends on the requirements of each project."
msgstr "Las herramientas de análisis de código pueden llevar algún tiempo. Por esa razón, decidimos ejecutar estas tareas sólo en las compilaciones nocturnas lanzadas por el programador de GitLab. Esta decisión depende de los requisitos de cada proyecto."

#. type: Title ==
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy, no-wrap
msgid "Dependency Bot"
msgstr "Bot de dependencia"

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "We are living in an age of continuous delivery code, and Quarkus is no exception. The team is releasing new versions with improvements and bugfixes at a fast pace. In addition to that, we crafted some utility libraries that are shared among our backends and frontends. When there are new releases, all the services should be updated."
msgstr "Vivimos en la era de la entrega continua de código, y Quarkus no es una excepción. El equipo está lanzando nuevas versiones con mejoras y correcciones de errores a un ritmo rápido. Además de eso, hemos creado algunas bibliotecas de utilidades que se comparten entre nuestros backends y frontends. Cuando hay nuevas versiones, todos los servicios deben actualizarse."

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "As of today (initial phase), we have ≈30 services, but a lot more are expected in the near future. Having a dependency bot to help us update these dependencies and run automated validation tasks is a must."
msgstr "A día de hoy (fase inicial), tenemos ≈30 servicios, pero se esperan muchos más en un futuro próximo. Disponer de un bot de dependencias que nos ayude a actualizar estas dependencias y ejecutar tareas de validación automatizadas es imprescindible."

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "As we are working with GitLab, one of the recommended options is Renovatebot. See https://docs.renovatebot.com/. It is relatively easy to setup, works seamlessly with Java, and is highly customizable."
msgstr "Como estamos trabajando con GitLab, una de las opciones recomendadas es Renovatebot. Véase  https://docs.renovatebot.com/  Es relativamente fácil de configurar, funciona perfectamente con Java y es altamente personalizable."

#. type: Title ==
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy, no-wrap
msgid "Security domains and DAO library"
msgstr "Dominios de seguridad y biblioteca DAO"

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "As part of the project, we had to code an utility JPA DAO library for simplifying the queries made by developers. As a result, the \"jpacriteria-dao\" library was born. Under the hoods, it uses the JPA criteria library."
msgstr "Como parte del proyecto, tuvimos que codificar una biblioteca DAO de JPA para simplificar las consultas realizadas por los desarrolladores. Como resultado, nació la biblioteca \"jpacriteria-dao\". Bajo el capó, utiliza la biblioteca de criterios JPA."

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "The main goals are:"
msgstr "Los principales objetivos son:"

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "Simplify the creation of queries. Developers only need to code DTO filters and map the attributes to criteria predicates. The library creates the final query. It automatically detects when to do inner/left joins, when to use distinct, etc."
msgstr "Simplifique la creación de consultas. Los desarrolladores sólo tienen que codificar filtros DTO y asignar los atributos a predicados de criterios. La biblioteca crea la consulta final. Detecta automáticamente cuándo realizar uniones internas/izquierdas, cuándo utilizar distinct, etc."

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "Support the use of `includeFields` with navigation, so the developers can choose which fields to query (`field1.field2.id`, `field1.field2.name`, etc). Executes a native Query and maps the result to a DTO. It is very useful to limit the scope of the query."
msgstr "Soporta el uso de `includeFields` con navegación, para que los desarrolladores puedan elegir qué campos consultar ( `field1.field2.id`, `field1.field2.name`, etc). Ejecuta una consulta nativa y asigna el resultado a un DTO. Es muy útil para limitar el alcance de la consulta."

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "In our system, we have security domains, with precedence. Some users must only see the data that belongs to their domain. The library, when instructed, can do the validations and filtering automatically at DAO level. Entities that need to support that must extend the `DataSecurity` interface."
msgstr "En nuestro sistema, tenemos dominios de seguridad, con precedencia. Algunos usuarios sólo deben ver los datos que pertenecen a su dominio. La biblioteca, cuando se le indique, puede hacer las validaciones y el filtrado automáticamente a nivel de DAO. Las entidades que necesiten soportar eso deben extender la interfaz `DataSecurity`."

#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid ""
"We decided to open source it, and it will probably be also deployed to Maven Central. The code is published in the https://github.com/sofisslat/jpacriteria-dao GitHub repository.\n"
"We also uploaded an example Quarkus app using the library (under the folder `example`). As of today, we see the library as a proof of concept, that can be evolved and improved."
msgstr "Decidimos hacerlo de código abierto, y probablemente también se desplegará en Maven Central. El código está publicado en el repositorio GitHub de https://github.com/sofisslat/jpacriteria-dao . También hemos subido una aplicación Quarkus de ejemplo que utiliza la biblioteca (en la carpeta `example` ). A día de hoy, vemos la biblioteca como una prueba de concepto, que puede evolucionar y mejorarse."

#. type: Title ==
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy, no-wrap
msgid "Logs (EFK)"
msgstr "Registros (EFK)"

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "When running multiple services and applications on a Kubernetes cluster, a centralized, cluster-level logging stack can help to quickly sort through and analyze the heavy volume of log data produced by the pods. One popular centralized logging solution is the Elasticsearch, Fluentd, and Kibana (EFK) stack. Data streams are the recommended way of storing logs in Elasticsearch. In a typical setup, all the logs have useful context information used for filtering as \"namespace\", \"service\", \"log level\", etc."
msgstr "Cuando se ejecutan varios servicios y aplicaciones en un clúster Kubernetes, una pila de registro centralizada a nivel de clúster puede ayudar a clasificar y analizar rápidamente el gran volumen de datos de registro producidos por los pods. Una solución popular de registro centralizado es la pila Elasticsearch, Fluentd y Kibana (EFK). Los flujos de datos son la forma recomendada de almacenar registros en Elasticsearch. En una configuración típica, todos los registros tienen información de contexto útil utilizada para el filtrado como \"espacio de nombres\", \"servicio\", \"nivel de registro\", etc."

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "The challenge lies in adding as much context as possible to the logged information, such as:"
msgstr "El reto consiste en añadir el máximo contexto posible a la información registrada, por ejemplo:"

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "traceId (link logs corresponding to a trace of invocations)"
msgstr "traceId (enlace a los registros correspondientes a una traza de invocaciones)"

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "tokenId (link logs corresponding to a JWT authorization token)"
msgstr "tokenId (registros de enlace correspondientes a un token de autorización JWT)"

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "userId/userCode (link logs corresponding to a given user)"
msgstr "userId/userCode (enlace a los registros correspondientes a un usuario determinado)"

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "This additional information helps our development team to debug errors reported by users."
msgstr "Esta información adicional ayuda a nuestro equipo de desarrollo a depurar los errores notificados por los usuarios."

#. type: Title ===
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy, no-wrap
msgid "JSON logging format"
msgstr "Formato de registro JSON"

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "It is possible to change the output format of the console log. This can be useful in environments where the output of the Quarkus application is captured by a service which processes and stores the log information for later analysis. In order to configure the JSON logging format, the `quarkus-logging-json` extension may be employed. See https://quarkus.io/guides/logging#json-logging."
msgstr "Es posible cambiar el formato de salida del registro de la consola. Esto puede ser útil en entornos en los que la salida de la aplicación Quarkus es capturada por un servicio que procesa y almacena la información de registro para su posterior análisis. Para configurar el formato de registro JSON, puede emplearse la extensión `quarkus-logging-json`. Véase  https://quarkus.io/guides/logging#json-logging"

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "In our case, this allowed us to add some extra parameters to the JSON log output, that are easily picked up by fluentd and sent to Elasticsearch."
msgstr "En nuestro caso, esto nos permitió añadir algunos parámetros adicionales a la salida de registro JSON, que son fácilmente recogidos por fluentd y enviados a Elasticsearch."

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "The `quarkus.log.console.json.exception-output-type=formatted` property is also used to send the stacktrace."
msgstr "La propiedad `quarkus.log.console.json.exception-output-type=formatted` también se utiliza para enviar el stacktrace."

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "Docker has a size limit of 16K for logs (https://github.com/kubernetes/kubernetes/issues/52444[kubernetes/kubernetes#52444] and https://github.com/moby/moby/issues/34620[moby/moby#34620]). An error with a large stacktrace is going to generate a split log. The proposed fluentd community solution is using the fluent-plugin-concat. Keep in mind that there are edge cases with rotating file logs when it might fail. Another solution is sending the logs directly as mentioned in https://quarkus.io/guides/centralized-log-management."
msgstr "Docker tiene un límite de tamaño de 16K para los logs link:https://github.com/kubernetes/kubernetes/issues/52444[(kubernetes/kubernetes#52444] y  link:https://github.com/moby/moby/issues/34620[moby/moby#34620]). Un error con un stacktrace grande va a generar un log dividido. La solución propuesta por la comunidad fluentd es usar el fluent-plugin-concat. Tenga en cuenta que hay casos extremos con los registros de archivos rotativos en los que podría fallar. Otra solución es enviar los registros directamente como se menciona en  https://quarkus.io/guides/centralized-log-management"

#. type: Title ===
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy, no-wrap
msgid "MDC (Mapped diagnostic context)"
msgstr "MDC (contexto de diagnóstico mapeado)"

#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid ""
"The typical Java logging API lets you log the level, exception message and stacktrace. Quarkus uses JBoss Log Manager under the hoods. Using `org.jboss.logmanager.MDC`, we have access to the `MDC.put(String key, String value)` method that allows us to add key-value parameters.\n"
"In order to set this information, a `javax.ws.rs.container.ContainerRequestFilter` should be implemented."
msgstr "La típica API de registro de Java le permite registrar el nivel, el mensaje de excepción y el stacktrace. Quarkus utiliza JBoss Log Manager bajo el capó. Utilizando `org.jboss.logmanager.MDC` , tenemos acceso al método `MDC.put(String key, String value)` que nos permite añadir parámetros clave-valor. Para establecer esta información, hay que implementar `javax.ws.rs.container.ContainerRequestFilter` ."

#. type: Title ===
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy, no-wrap
msgid "Obtaining the parameters"
msgstr "Obtención de los parámetros"

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "The tokenId, userId and userCode are obtained from the JsonWebToken used to invoke the API."
msgstr "El tokenId, userId y userCode se obtienen del JsonWebToken utilizado para invocar la API."

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "The traceId, is generated by the `quarkus-opentelemetry` extension. The extension is responsible for transparently propagating the trace through the different REST invocations that are made from the backends. We wanted to use the traceId only for logging, without an external visualizing tool like Jaeger, so we disabled the OTLP Exporter with `quarkus.opentelemetry.tracer.exporter.otlp.enabled=false`."
msgstr "El traceId, es generado por la extensión `quarkus-opentelemetry`. La extensión se encarga de propagar de forma transparente la traza a través de las diferentes invocaciones REST que se realizan desde los backends. Queríamos utilizar el traceId sólo para el registro, sin una herramienta de visualización externa como Jaeger, por lo que desactivamos el exportador OTLP con `quarkus.opentelemetry.tracer.exporter.otlp.enabled=false`."

#. type: Title ==
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy, no-wrap
msgid "Final thoughts"
msgstr "Reflexiones finales"

#. type: Plain text
#: _posts/2023-05-09-ministry-of-economy-finance-uruguay-adopts-quarkus.adoc
#, fuzzy
msgid "We initially adopted Thorntail (previously known as Wildfly-Swarm) for our service-oriented architecture projects, but switched to Quarkus at the beginning of its 1.x release due to its superior features. Quarkus has proven to be an excellent choice for us, and we have greatly enjoyed working with it and its extensions over the past few years. As of today, the new base architecture is already defined, and SIIF started its migration. At least 5 more years of work with it and other internal systems is expected. Undoubtedly, we will continue working and improving this architecture for the years to come, aligned with the Quarkus ecosystem. We extend our gratitude to the entire Quarkus team and the enthusiastic community behind the project, of which we are proud to be a part."
msgstr "Inicialmente adoptamos Thorntail (antes conocido como Wildfly-Swarm) para nuestros proyectos de arquitectura orientada a servicios, pero cambiamos a Quarkus al principio de su versión 1.x debido a sus características superiores. Quarkus ha demostrado ser una excelente opción para nosotros, y hemos disfrutado mucho trabajando con él y sus extensiones en los últimos años. A día de hoy, la nueva arquitectura base ya está definida, y SIIF ha comenzado su migración. Nos esperan al menos 5 años más de trabajo con ella y otros sistemas internos. Sin duda, seguiremos trabajando y mejorando esta arquitectura durante los próximos años, alineados con el ecosistema Quarkus. Extendemos nuestro agradecimiento a todo el equipo de Quarkus y a la entusiasta comunidad que hay detrás del proyecto, de la que estamos orgullosos de formar parte."
